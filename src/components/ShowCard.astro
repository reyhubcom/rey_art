---
import { TicketsIcon, GlobeIcon } from "../icons";

interface Props {
  title: string;
  date: string;
  city: string;
  country?: string;
  venue: string;
  tickets?: string;
  available: boolean;
}

const { date, city, country, venue, tickets, available }: Props = Astro.props;

const d = new Date(date);

// formato en español
const weekday = new Intl.DateTimeFormat("es-AR", { weekday: "short" })
  .format(d)
  .toUpperCase();
const day = new Intl.DateTimeFormat("es-AR", { day: "2-digit" }).format(d);
const month = new Intl.DateTimeFormat("es-AR", { month: "short" })
  .format(d)
  .toUpperCase();

// bandera dinámica: <span class="fi fi-ar"></span>
const cc = (country ?? "").toLowerCase();
const flagClass = cc ? `fi fi-${cc}` : null;
---

<li
  class="bg-white/5 backdrop-blur-xl rounded-2xl p-4 border border-white/10 hover:border-white/20 transition-all duration-300 hover:bg-white/10 hover:shadow-xl"
>
  <div class="flex items-start justify-between gap-2">
    <div
      class="flex flex-col items-center justify-center size-16 p-0.5 rounded-lg bg-background/20 text-center"
    >
      <div class="text-xs font-semibold text-muted-foreground">{weekday}</div>
      <div class="text-xl font-bold leading-none">{day}</div>
      <div class="text-xs uppercase text-muted-foreground">{month}</div>
    </div>

    <div class="flex-1">
      <div class="flex items-center gap-2 mb-2">
        <div>
          <h3 class="text-foreground font-semibold">{venue}</h3>
          <p class="text-foreground/70 flex items-center gap-1">
            {
              flagClass ? (
                <span class={`${flagClass} rounded shrink-0`} title={country} />
              ) : (
                <GlobeIcon size={18} class="text-muted-foreground shrink-0" />
              )
            }
            {city}
          </p>
        </div>
      </div>
    </div>
    <div class="text-right">
      {
        tickets && available && (
          <a
            href={tickets!}
            class="inline-flex items-center justify-center w-10 h-10 bg-foreground/10 hover:bg-foreground/20 backdrop-blur-xl text-green-400 rounded-full transition-all duration-200 hover:scale-110 border border-white/20"
            title="Comprar tickets"
            aria-label="Comprar tickets"
          >
            <TicketsIcon size={18} />
          </a>
        )
      }

      {
        tickets && !available && (
          <span class="inline-flex text-sm items-center gap-2 px-3 py-2 rounded-xl bg-muted text-muted-foreground shrink-0">
            <span>Agotado</span>
          </span>
        )
      }
    </div>
  </div>
</li>
